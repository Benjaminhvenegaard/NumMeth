"CODE" 31096;
"PROCEDURE"COMFOUSER1(N,THETA,AR,AI,RR,RI);
"VALUE"N,THETA;"INTEGER"N;"REAL"THETA,RR,RI;"ARRAY"AR,AI;
"BEGIN""INTEGER"K;"REAL"H,HR,HI,CO,SI;
   HR:=HI:=0;CO:=COS(THETA);SI:=SIN(THETA);
   "FOR"K:=N"STEP"-1"UNTIL"1"DO"
   "BEGIN"H:=CO*HR-SI*HI+AR[K];
         HI:=CO*HI+SI*HR+AI[K];
         HR:=H
   "END";
   RR:=CO*HR-SI*HI+AR[0];
   RI:=CO*HI+SI*HR+AI[0]
"END"COMFOUSER1;
        "EOP"
